
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
    Html.RenderPartial("_PartialIndex");
}

<style type="text/css">
    body {
        background-color: #efefef;
        line-height: 24px;
        font: 12px/1.5 'Microsoft Yahei', 'Simsun';
        color: #666666;
    }
</style>


<div class="layui-container container" id="warp">
    <div class="layui-row layui-col-space10">
        <a>@ViewBag.Aa</a>
        <div class="layui-col-md8" style="padding-right: 16px">
            <div class="article-main">
                <div v-for="(item,index) in list" style="padding: 0px 0px; background: #fff; margin-top: 10px">
                    <div class="layui-card">
                        <div class="layui-card-body">
                            <div class="caption-subject uppercase" style="font-size: 18px; color: #444; font-weight: 600;">
                                <h2>
                                    <a :href="'/Answer/Index/'+item.id" :title="item.name" target="_blank" style="font-size: 18px; color: #445; font-weight: 600;">{{item.title}}</a>
                                </h2>
                            </div>
                            <p style="margin:15px 0 10px 0">
                                <a href="/user/15985459135" target="_blank">
                                    <img src="https://img.tnblog.net/userdata/minheads/min_73a057e6dcca4c539347788275ae3076.jpeg" style="width:22px;height:22px;border-radius:30%;margin-top:-4px">
                                </a>
                                <span class=" f_r" style="padding-left: 4px"><b><a href="https://www.tnblog.net/user/15985459135" target="_blank">雨辰</a></b></span>
                            </p>
                            <div style="margin: 10px 0 10px 0; font-size: 14px;text-indent:2em;">
                                <a href="#"> {{item.desc}}</a>
                            </div>
                            <p class="autor">
                                <button class="layui-btn layui-btn-sm layui-btn-primary">
                                    <i class="layui-icon layui-icon-praise" style="vertical-align: middle;"></i>
                                    <a style="font-size: 1.10em;">10</a>
                                </button>
                                <span class="viewnum f_r">回答(<a href="#">7</a>)</span>
                                <span class="viewnum f_r">浏览(<a href="#">{{item.views}}</a>)</span>
                                <span class="lm f_l"><a v-for="ctag in tagSplit(item.tag)" :href="'/Tag/Index/'+ctag" target="_blank">{{ctag}} </a></span>
                                <span class="dtime f_l" :title="'提问时间:'+item.createTime">{{item.createTime}}</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="layui-col-md4" id="crightdiv" style="position: static;">

            <div class="layui-form-item">
                <button id="Search_Btn" @@click="ShowLayer()" data-method="offset" data-type="auto" class="layui-btn layui-btn-fluid layui-btn-normal">我要提问</button>
                <div class="layui-btn-group">
                    @*<button class="layui-btn layui-btn-lg" id="searchbut" lay-filter="*"> 我要回答 </button>*@
                </div>
            </div>

            <div class="cloud">
                <h3 style="margin-top: 10px">问答标签</h3>
                <ul>
                    <li><a href="/Nav/1">.NET</a></li>
                    <li><a href="/Nav/2">.NET Core</a></li>
                    <li><a href="/Nav/3">.NET MVC</a></li>
                    <li><a href="/Nav/5">JAVA</a></li>
                    <li><a href="/Nav/7">消息队列</a></li>
                    <li><a href="/Nav/8">Python</a></li>
                    <li><a href="/Nav/12">数据库</a></li>
                    <li><a href="/Nav/13">缓存</a></li>
                    <li><a href="/Nav/18">云服务</a></li>
                    <li><a href="/Nav/19">架构</a></li>
                    <li><a href="/Nav/20">Linux</a></li>
                    <li><a href="/Nav/21">微信</a></li>
                    <li><a href="/Nav/22">随笔</a></li>
                    <li><a href="/Nav/Other">其他</a></li>
                </ul>
            </div>
        </div>
    </div>


    <div id="question" style="display:none;padding:15px;">
        <form>
            <div class="question-content">
                <div class="layui-form-item">
                    <input type="text" name="title" v-model="question.title" lay-verify="required" placeholder="请输入问题标题" autocomplete="off" class="layui-input">
                </div>
                <div class="layui-form-item">
                    <textarea placeholder="请输入问题描述" class="layui-textarea" v-model="question.desc"></textarea>
                </div>
                <div class="layui-form-item">
                    <input type="text" name="title" required lay-verify="required" placeholder="问题分类(逗号隔开)" autocomplete="off" class="layui-input" v-model="question.tag">
                </div>
                <div class="layui-input-block" style="float:right">
                    <button type="button" class="layui-btn layui-btn-normal" @@click="Askquestion()">发布问题</button>
                </div>
            </div>
        </form>
    </div>
</div>



@section Scripts{
    <script type="text/javascript">
    new Vue({
        el: "#warp",
        data: {
            question: {},//{ tagId: "1,2,3", desc: "1231233", title: "name" },
                list: []
                //{ "id": 1, "name": "oracle数据库表dual的讲解", "desc": "我希望有个如你一般的人我还是很喜欢你，像日光洒满天地，温柔惬意。先提个问 ：oracle数据库里dual表是什么表？...", author: "陪你听风", createtime: "2020-06-05", fromtag: "其他" },
                //{ "id": 2, "name": "屏幕截图1", "desc": "icPick 是一款优秀的免费屏幕截图工具", author: "雨辰", createtime: "2019-9-16 17:24:50", fromtag: "其他" },
                //{ "id": 3, "name": "屏幕截图2", "desc": "icPick 是一款优秀的免费屏幕截图工具", author: "雨辰", createtime: "2019-9-16 17:24:50", fromtag: "其他" }]

            },
            mounted() {
                this.InitData();
            },
            computed: {
                tagSplit: function () {
                    return function (tag) {
                        return (tag || "").split(",");
                    }
                }
            },
            methods: {
                InitData: function () {
            
                      let that = this;
                    $.get('@Url.Action("GetQuestionByTag")', {id:'@Html.ViewContext.RouteData.Values["id"]'}, function (data) {
                        console.log(data);
                        that.list = data;
                    });
                },

                Askquestion: function () {
                    $.post('@Url.Action("Ask")', this.question, function (data) {
                        console.log(data);
                        if (data.Status) {
                            location.reload(true);
                        }
                    });

                }
            }
        });


        $(function () {
            $("#bdcsMain").keyup(function () {
                if (event.keyCode == 13) {
                    //触发搜索按钮,就不用就封装方法了
                    $("#searchbut").click();
                }
            });

        });
    </script>

}